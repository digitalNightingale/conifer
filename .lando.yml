name: conifer
recipe: wordpress
config:
  webroot: wp

services:
  appserver:
    build:
      - cd $LANDO_MOUNT && composer install

  node:
    type: node:6.11

    globals:
      newman: "1.3.2"

  phpmyadmin:
    type: phpmyadmin:4.7

  mailhog:
    type: mailhog:v1.0.0
    hogfrom:
      - appserver

tooling:
  install:
    service: appserver
    cmd: '/app/scripts/setup-wordpress.bash'
    description: 'Install and configure WordPress for custom plugin dev'

  newman:
    service: node

proxy:
  appserver:
    - conifer.lndo.site

  mailhog:
    - mail.groot.lndo.site

events:
  post-install:
    # ensure WordPress is installed and configured
    - wp --path="$LANDO_MOUNT/wp" plugin uninstall hello akismet
    - wp --path="$LANDO_MOUNT/wp" plugin activate timber-library conifer
    - wp --path="$LANDO_MOUNT/wp" theme activate groot
    - wp --path="$LANDO_MOUNT/wp" theme uninstall twentyfifteen twentysixteen twentyseventeen
